---
layout: default
title: "Domain Robust"
parent: "Paper review"
nav_order: 3
permalink: /docs/review/3
---

# Generative Adversarial Speaker Embedding Networks for Domain Robust End-to-End Speaker Verification

#### Gautam Bhattacharya, Joao Monteiro, Jahangir Alam, Patrick Kenny

### âœ Abstract ğŸ”
- GANsë¥¼ ì´ìš©í•œ domain invariant speaker embeddingì„ ìœ„í•œ ìƒˆë¡œìš´ ì ‘ê·¼ ë°©ì‹ ì œì•ˆ
	\- source dataì™€ target dataë¡œ generatorê°€ embeddingì„ ìƒì„±
	\- ìƒì„±ëœ embeddingì´ sourceì¸ì§€ targetì¸ì§€ discriminatorê°€ ì‹ë³„

- **ì´ëŸ¬í•œ frameworkë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°€ì§€ GAN ë³€í˜•ì„ í›ˆë ¨í•˜ê³  í™”ì ê²€ì¦ì— ì ìš©**

- Angular Margin lossë¥¼ ì‚¬ìš©í•˜ì—¬ End-to-End model ìµœì í™”
<center><img src="https://user-images.githubusercontent.com/46676700/92461324-1e474680-f204-11ea-91bc-e748da169035.png" alt="img" style="zoom: 80%;" /></center>

<br/>

---

<br/>
### â… . Introduction ğŸ”
\- í™”ì embedding : ê°œì¸ì˜ identityì™€ ê´€ë ¨ëœ ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” ì €ì°¨ì› ë²¡í„° í‘œí˜„

<br/>

**âœ”  Neural Networkê¸°ë°˜ í™”ì embedding**

- ìŒì„± ì¸ì‹, í•©ì„± ë° source ë¶„ë¦¬, í™”ì ê²€ì¦ ì ìš© ë“± ë‹¤ì–‘í•˜ê²Œ ì ìš©

<br/>

**âœ”  End-to-End system speaker verification**

- ë‘ ê°œì˜ ìŒì„± íŒŒì¼ì—ì„œ embeddingì„ ì¶”ì¶œí•œ ë’¤ embedding ì‚¬ì´ì˜ cosine distance ë“±ì„ ì‚¬ìš©í•˜ì—¬ score ê³„ì‚°
- ëª¨ë¸ì´ ê²¬ê³ í•˜ê¸° ìœ„í•´ì„œ ì¼ë°˜ì ìœ¼ë¡œ ê±°ë¦¬ ì¸¡ì • ê¸°ì¤€ì„ ì§ì ‘ ìµœì í™”í•´ì•¼ í•¨ (End-to-End)
- ê·¸ëŸ¬ë‚˜, í™”ì ê²€ì¦ì—ì„œ í›ˆë ¨í•˜ê¸° ì–´ë ¤ìš´ ê²ƒìœ¼ë¡œ íŒë‹¨

<br/>

**âœ”  I-vector systemê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©**

- ì°¨ì› ê°ì†Œì—ëŠ” LDA(Linear Discriminant Analysis) ì‚¬ìš©
- ê²€ì¦ ì‹œ PLDA(Probabilistic Linear Discriminant Analysis) ì‚¬ìš©

<br/>

**âœ”  NIST SRE 2016 dataset ì‚¬ìš©**

- í›ˆë ¨ ë°ì´í„°(ì˜ì–´)ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°(ê´‘ë‘¥ì–´ ë° íƒ€ê°ˆë¡œê·¸ì–´) ì‚¬ì´ì˜ mismatchë¥¼ ë„ì… (Domain or Covariate shift)
- domain ë³´ìƒì„ ìœ„í•œ ì ì€ ì–‘ì˜ labelì´ ì—†ëŠ” target ë°ì´í„° ì œê³µ

<br/>

**âœ”  ë³¸ ë…¼ë¬¸ ì €ìì˜ ìµœê·¼ ì—°êµ¬ì—ì„œ, End-to-Endì˜ cosine scoreë¥¼ ì‚¬ìš©í•˜ëŠ” domain adversarial í›ˆë ¨ì„ ì´ìš©í•œ domain ë¶ˆë³€ í™”ì embedding í›ˆë ¨ ì œì•ˆ (Domain Adversarial Neural Speaker Embeddings, DANSE)**

- Gradient reversalì„ ì‚¬ìš©í•˜ì—¬ domain ë¶ˆë³€ì„± ë° adversarial grameì˜ ìµœì†Œí™” ëª©í‘œë¥¼ ë‹¬ì„±

<br/>

<span style="background-color:#f4d451">**âœ”  ë³¸ ë…¼ë¬¸ì—ì„œëŠ” GANsë¥¼ ì‚¬ìš©í•˜ì—¬ unsupervised domain adaptation/invariantë¡œ ì´ì „ ì—°êµ¬ í™•ì¥**</span>
< ì¥ì >

- gradient reversalë³´ë‹¤ ë¶ˆë³€ì„± mappingì„ í•™ìŠµí•˜ëŠ”ë° ë” ë‚˜ì€ gradients ì œê³µ
- GAN frameworkëŠ” gradient reversalë³´ë‹¤ ë” ì¼ë°˜ì ì´ê³  í™•ì¥ ê°€ëŠ¥

<br/>

**âœ”  ë‹¤ì–‘í•œ GAN ë³€í˜•**

- íŠ¹ì§• ê³µê°„ì˜ ë‹¤ë¥¸ ë³€í˜•ì„ ìƒì„±
- ì´ëŸ¬í•œ íŠ¹ì§• ê³µê°„ì„ ê²°í•©ì´ ì„±ëŠ¥ í–¥ìƒì„ ê°€ì ¸ì˜´
- Auxiliary Classifier GAN(AuxGAN)ì˜ ìˆ˜ì •ì„ ì œì•ˆ
- GAN ëª¨ë¸ì´ DNASE ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ëŠ¥ê°€
- ë‹¤ì–‘í•œ GAN ëª¨ë¸ì˜ scoreë¥¼ í‰ê· í•¨ìœ¼ë¡œì¨ x-vectorì˜ ì„±ëŠ¥ë³´ë‹¤ í–¥ìƒë¨

<br/>

---


<br/>

### â…¡. Domain Adaption with GANs ğŸ”

**âœ”  GAN**

- Generator : target dataë¥¼ source dataì˜ domainìœ¼ë¡œ mapping
- Discriminator : source dataì™€ target dataì˜ domainì„ êµ¬ë³„

<center><img src="https://user-images.githubusercontent.com/46676700/92464311-ecd07a00-f207-11ea-8527-64991f1f261d.png" alt="img" style="zoom: 70%;" /></center>

- ì—¬ëŸ¬ GAN ë³€í˜•ì— í•´ë‹¹í•˜ëŠ” ë‹¤ë¥¸ discriminatorì˜ êµ¬ì„±ì´ íŠ¹ì§• ê³µê°„ì˜ ë‹¤ë¥¸ ë³€í™˜ì„ ê°€ì ¸ì˜¨ë‹¤ëŠ” ê²ƒì„ ë°œê²¬
- vanilla GANì—ì„œ discriminatorëŠ” binary cross-entropy(BCE) lossë¥¼ ìµœì í™”í•˜ì—¬ í›ˆë ¨

<br/>

**âœ”  GAN game (ê¸°ì¡´ GAN loss)**

<center><img src="https://user-images.githubusercontent.com/46676700/92464831-af202100-f208-11ea-9c86-bb4318bebe00.png" alt="img" style="zoom: 50%;" /></center>

- E, D : Embedding(generator), Discriminator í•¨ìˆ˜

<center><img src="https://user-images.githubusercontent.com/46676700/92472815-fc09f480-f214-11ea-9b00-1274915072c1.png" alt="img" style="zoom: 70%;" /></center>

<br/>

**âœ”  Gradients reversal model**

<center><img src="https://user-images.githubusercontent.com/46676700/92472846-01673f00-f215-11ea-8f18-c267f86a118d.png" alt="img" style="zoom: 80%;" /></center>

<br/>

---

<br/>

### â…¢. Generative Adversarial Speaker Embedding Networks ğŸ”

**âœ”  ë³¸ ë…¼ë¬¸ì˜ ëª©í‘œ**

- í™”ì embedding modelì´ íŠ¹ì§• ì¶”ì¶œê¸°(generator)ì™€ domain ì‹ë³„ì(discriminator) ì‚¬ì´ì˜ GAN gameì„ í†µí•´ domain ë¶ˆë³€ì  íŠ¹ì§•ì„ í•™ìŠµ
- GANì´ domain ë¶ˆë³€ì„±ì„ ê°–ìœ¼ë©°, embeddingì´ í™”ìë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆì–´ì•¼ í•¨

<br/>

**âœ”  Loss function (AM-softmax/GAN loss)**

- classê°„ cosine similarityë¥¼ ì§ì ‘ ìµœì í™”
<center><img src="https://user-images.githubusercontent.com/46676700/92466967-d7f5e580-f20b-11ea-9b8b-ae4db11acd0b.png" alt="img" style="zoom: 50%;" /></center>

- C, E : Classifier, Embedding(generator)  í•¨ìˆ˜

<br/>

<center><img src="https://user-images.githubusercontent.com/46676700/92467164-17243680-f20c-11ea-83c2-adb068c4d9df.png" alt="img" style="zoom: 40%;" /></center>

- s, m : scale factor, margin

<br/>

- BCE lossë¥¼ ì‚¬ìš©í•˜ì—¬ domain discriminatorë¥¼ í›ˆë ¨
<center><img src="https://user-images.githubusercontent.com/46676700/92467390-7d10be00-f20c-11ea-9136-515c58c834d9.png" alt="img" style="zoom: 50%;" /></center>

- ë§ˆì§€ë§‰ìœ¼ë¡œ, ì•„ë˜ì˜ lossë¥¼ ì‚¬ìš©í•˜ì—¬ discriminatorë¥¼ ì†ì´ê¸° ìœ„í•´ generator(embedding) í›ˆë ¨
<center><img src="https://user-images.githubusercontent.com/46676700/92467437-9580d880-f20c-11ea-9aa0-c336bf2bd007.png" alt="img" style="zoom: 50%;" /></center>

- embedding í•¨ìˆ˜ëŠ” task lossì™€ í•¨ê»˜ ê·¸ ë‹¤ìŒ adversarial loss ì´ 2ë²ˆ í•™ìŠµ

<br/>
<br/>

##### 3.1. Auxiliary Classifier GAN

**âœ”  AuxGAN(ACGAN)**

- ì¡°ê±´(conditional) ì´ë¯¸ì§€ ìƒì„±ì„ ìœ„í•´ ë³´ì¡°(Auxiliary) lossë¥¼ ì‚¬ìš©í•˜ì—¬ GANì„ ë³´ì™„

- side ì •ë³´(class label ë“±)ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ ëª©í‘œ

- D (discriminator) : 2ê°œì˜ classifier
   \- ë°ì´í„°ê°€ ì§„ì§œ(real) ì¸ì§€ ê°€ì§œ(fake) ì¸ì§€ íŒë³„
   \- í•´ë‹¹ ë°ì´í„°ì˜ ë²”ì£¼(category)ë¥¼ ë¶„ë¥˜

- G (generator) : labelì •ë³´ì™€ z(noise)ë¡œ ê°€ì§œ ë°ì´í„° ìƒì„±

<center><img src="https://user-images.githubusercontent.com/46676700/92468316-ec3ae200-f20d-11ea-882d-0045ffc0cd5c.png" alt="img" style="zoom: 50%;" /></center>

**âœ”  ì›ë˜ ACGANì˜ object fuction**

- sourceì˜ log-likelihood L_s, classì˜ log-likelihood L_c
- L_s : ê¸°ì¡´ GANì˜ ëª©ì  í•¨ìˆ˜ì™€ ê°™ìŒ (real/fake íŒë³„)
- L_c : í•´ë‹¹ ë°ì´í„°ì˜ classë¥¼ íŒë‹¨ (conditional-GAN, CGANê³¼ ìœ ì‚¬)

<br/>

- D(discriminator)ëŠ” L_s + L_cë¥¼ ìµœëŒ€í™”
- G(generator)ëŠ” L_c - L_së¥¼ ìµœëŒ€í™”

<br/>

<center><img src="https://user-images.githubusercontent.com/46676700/92473528-b699f700-f215-11ea-8256-b66f1ff59f9b.png" alt="img" style="zoom: 70%;" /></center>

<br/>

**âœ”  ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ ACGANì˜ object function**

<center><img src="https://user-images.githubusercontent.com/46676700/92469327-9a935700-f20f-11ea-8183-b78231d799d4.png" alt="img" style="zoom: 50%;" /></center>

<br/>

##### 3.2. GAN Variants

**ğŸ”¹  ë‹¤ì–‘í•œ GANì˜ ë³€í˜• ì‚¬ìš©**

- í‘œì¤€ GAN
- Least-Squares GAN
- Relativistic GAN

**ğŸ”¹  ê° ë³€í˜•ì´ íŠ¹ì§• ê³µê°„ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë³€í˜•**

- ëª¨ë“  ëª¨ë¸ì€ ê±°ì˜ ë¹„ìŠ·í•œ ì„±ëŠ¥ì„ ë³´ì„

**ğŸ”¹ ëª¨ë“  GAN ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ê²°í•©**

- í‰ê·  ì ìˆ˜(cosine distance score)ë¥¼ ê²°í•©í•œ ê²ƒì´ ìµœê³ ì˜ ì„±ëŠ¥ì„ ë³´ì„

<br/>

---

<br/>

### â…£.  Experiments and Results ğŸ”

**âœ”  Training data(source)**

<br/>

- ì œì•ˆí•œ DANSE ëª¨ë¸ê³¼ x vector, i vector ì˜ baseline ì„ í›ˆë ¨í•˜ê¸° ìœ„í•´ NIST SRE 2004 2010 ë° Switchboard Cellular audio ì‚¬ìš©
- ì¡ìŒ ë° ì”í–¥ìœ¼ë¡œ ë°ì´í„° ì¦ê°• (128Kì˜ noisy dataì¶”ê°€í•˜ì—¬, 220Kê°œ ì‚¬ìš©)
- Adversarial ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•´ , 5 ê°œ ì´í•˜ì˜ ë°œí™”ì¸ í™”ìëŠ” ê±¸ëŸ¬ë‚´ê³  ì•½ 6000 ëª…ì˜ í™”ìë¥¼ ì‚¬ìš©
- x-vector, i-vector ëŠ” Kaldi toolkit ì‚¬ìš©
- ëŒ€ë¶€ë¶„ì´ ì˜ì–´ ì‚¬ìš©ì ì´ë©° , ì „í™”ë¥¼ í†µí•´ ë…¹ìŒ

<br/>

**âœ”  Model**

<br/>

- Embedding(generator) í•¨ìˆ˜ëŠ” 3X 2 3 input ì˜ Convolutional layer, 4 ê°œì˜ residual block, attentive statistics layer, 2 ê°œì˜ fully connected layer (512, 512) ë¡œ êµ¬ì„±
- ClassifierëŠ” fully connected layer (64) ì™€ AM softmax output layer ë¡œ êµ¬ì„± (fully connected layer ê°€ ìµœì¢… domain ë¶ˆí¸ í™”ì embedding)
- DiscriminatorëŠ” 2 ê°œì˜ fully connected layer (256, 256) ì™€ binary cross entropy output layer ë¡œ êµ¬ì„±
- ELU(Exponential Linear Units)ë¥¼ ëª¨ë“  ê³„ì¸µì— ì‚¬ìš©
- Batch normalizationì€ attentive statistics layer ë¥¼ ì‚¬ìš©í•œ ê³„ì¸µì— ì‚¬ìš©
- AMsoftmax loss ì˜ s ì™€ m parameter ëŠ” ê°ê° 30 ê³¼ 0.6 ìœ¼ë¡œ ì„¤ì •

<br/>

**âœ”  Optimization**

<br/>

- cross entropy í›ˆë ¨ì„ ì‚¬ìš©í•˜ì—¬ embedding íŠ¹ì§•ì„ ì‚¬ì „ í›ˆë ¨
- ì„¸ ê°€ì§€ ë„¤íŠ¸ì›Œí¬ (embedding íŠ¹ì§• , Classifier, ë¥¼ ì„œë¡œ ë‹¤ë¥¸ optimizer ì‚¬ìš©
- DiscriminatorëŠ” lr = 0.003 ì˜ RMSprop , Classifier ì™€ embedding ì€lr 0.001 ì˜ SGD ì‚¬ìš©

<br/>

**âœ”  Data sampling**

<br/>

- í›ˆë ¨ ì¤‘ í›ˆë ¨ set ì˜ ê° ë…¹ìŒì—ì„œ ë¬´ì‘ìœ„ë¡œ audio chunk sampling
- ê° ìŒì„±ì„ 10 ë²ˆ sampling (epoch)
- Source dataì˜ mini batch ì— ëŒ€í•´ GAN í›ˆë ¨ì„ ìœ„í•œ label ì´ ì—†ëŠ” adaption data ë„ ë™ì¼í•˜ê²Œ ë¬´ì‘ìœ„ë¡œ mini batch ë¥¼ sampling

<br/>

**âœ”  Speaker Verification**

<br/>

- Testì‹œ embedding ì¶”ì¶œì— í•„ìš”í•˜ì§€ ì•Šì€ domain discriminator ë¥¼ ì—†ì•°
- 64ì°¨ì›ì˜ ë§ˆì§€ë§‰ hidden layer ê°€ ìµœì¢… í™”ì embedding
- Verificationì‹¤í—˜ì€ cosine distance ë¥¼ ì‚¬ìš©í•˜ì—¬ score ê³„ì‚°
- ì„±ëŠ¥ì˜ ì§€í‘œëŠ” EER ì‚¬ìš©

<br/>

**âœ”  Model block**

<br/>
<center><img src="https://user-images.githubusercontent.com/46676700/92470103-e5fa3500-f210-11ea-8ca4-58b5d1bcf508.png" alt="img" style="zoom: 50%;" /></center>
<center><img src="https://user-images.githubusercontent.com/46676700/92470119-ebf01600-f210-11ea-8d0b-bab531d6d72d.png" alt="img" style="zoom: 50%;" /></center>

<br/>

**âœ”  ì œì•ˆí•œ adversarial í™”ì embeddingê³¼ baseline system ì„±ëŠ¥ ë¹„êµ**

- Baselineì‹œìŠ¤í…œ ì¤‘ì—ì„œëŠ” DNN ê¸°ë°˜ì˜ x vector ì‹œìŠ¤í…œì´ LDA ì°¨ì› ê°ì†Œ ì¶”ê°€í•˜ëŠ” ê²ƒ ë§Œìœ¼ë¡œë„ i-vector ì˜ ì„±ëŠ¥ë³´ë‹¤ í–¥ìƒ
- ëª¨ë“  GAN ê¸°ë°˜ì˜ ëª¨ë¸ì´ DANSE ë³´ë‹¤ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë³´ì„
- AuxGAN(ACGAN), LSGAN, RelGAN embedding ì˜ score ë¥¼ í‰ê· í•œ ê²ƒì´ ê°€ì¥ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•¨

<br/>

<center><img src="https://user-images.githubusercontent.com/46676700/92470359-3d98a080-f211-11ea-8d38-75adaeb55df0.png" alt="img" style="zoom: 50%;" /></center>

<br/>

---

<br/>

### â…¤.  Conclusion ğŸ”

- GANsë¥¼ ì´ìš©í•œ domain ë¶ˆë³€ í™”ì embedding í•™ìŠµì„ ìœ„í•œ ìƒˆë¡œìš´ framework ì œì•ˆ
- ì—¬ëŸ¬ ê°€ì§€ GAN ì˜ ë³€í˜•ì„ í•™ìŠµí•˜ì—¬ score ë¥¼ ê²°í•©í•¨ìœ¼ë¡œì¨ í¬ê²Œ í–¥ìƒëœ ì„±ëŠ¥ì„ ì–»ìŒ
- End-to-End model ì— ìµœì í™”ë˜ì–´ ìˆìœ¼ë©° ê°„ë‹¨í•œ cosine distance ë¥¼ ì‚¬ìš©í•˜ì—¬ score ë¥¼ ê³„ì‚°

<br/>

- í–¥í›„ íŠ¹ì§• ê³µê°„ê³¼ ë°ì´í„° ê³µê°„ GAN ì˜ ê²°í•© ë° GAN ê¸°ë°˜ íŠ¹ì§• ê³µê°„ ì¦ê°• ë°©ë²•ê³¼ ê°™ì´ ë‹¤ë¥¸ adversarial ì „ëµì„ ê³ ë ¤í•  ê²ƒ
